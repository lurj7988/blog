import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as r,c as l,b as e,d as s,f as t,e as n}from"./app-55dec57a.js";const d={},c=e("h2",{id:"introduction",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#introduction","aria-hidden":"true"},"#"),s(" Introduction")],-1),p={href:"https://developer.apple.com/homekit/",target:"_blank",rel:"noopener noreferrer"},h={href:"https://www.espressif.com/en/products/sdks/esp-homekit-sdk",target:"_blank",rel:"noopener noreferrer"},u={href:"https://github.com/espressif/esp-apple-homekit-adk",target:"_blank",rel:"noopener noreferrer"},m=e("p",null,"Features of this SDK:",-1),f=e("ul",null,[e("li",null,"Easy APIs to implement all standard HomeKit profiles defined by Apple."),e("li",null,"Facility to add customised accessory specific Services and Characteristics."),e("li",null,"Samples (Fan, Lightbulb, Outlet, Bridge, Data-TLV8, Ethernet) to enable quick accessory development."),e("li",null,"Support for ESP Unified Provisioning.")],-1),v=e("h2",{id:"get-started",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#get-started","aria-hidden":"true"},"#"),s(" Get Started")],-1),b=e("h3",{id:"set-up-host-environment",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#set-up-host-environment","aria-hidden":"true"},"#"),s(" Set up Host environment")],-1),g=e("strong",null,"master",-1),k={href:"https://docs.espressif.com/projects/esp-idf/en/latest/get-started/index.html",target:"_blank",rel:"noopener noreferrer"},S=e("strong",null,"ESP8266",-1),_=e("strong",null,"master",-1),y={href:"https://docs.espressif.com/projects/esp8266-rtos-sdk/en/latest/get-started/",target:"_blank",rel:"noopener noreferrer"},x=n(`<h3 id="get-esp-homekit-sdk" tabindex="-1"><a class="header-anchor" href="#get-esp-homekit-sdk" aria-hidden="true">#</a> Get esp-homekit-sdk</h3><p>Please clone this repository using the below command:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">git</span> clone <span class="token parameter variable">--recursive</span> https://github.com/espressif/esp-homekit-sdk.git
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>Note the --recursive option. This is required to pull in the JSON dependencies into esp-homekit-sdk. In case you have already cloned the repository without this option, execute this to pull in the submodules: <code>git submodule update --init --recursive</code></p><p>If you had already cloned the repository and submodules earlier, you may have to execute <code>git submodule sync --recursive</code> once since the submodule paths have changed.</p></blockquote><h3 id="compile-and-flash" tabindex="-1"><a class="header-anchor" href="#compile-and-flash" aria-hidden="true">#</a> Compile and Flash</h3><p>You can use esp-homekit-sdk with any ESP32, ESP32-S2, ESP32-C3 or ESP8266 board (though we have tested only with the ESP32-DevKit-C, ESP32-S2-Saola-1, ESP32-C3-DevKit-M-1, ESP8266-DevKit-C). We have provided multiple examples for reference. Compile and flash as below (fan used as example):</p><h4 id="for-esp32-esp32-s2-esp32-c3" tabindex="-1"><a class="header-anchor" href="#for-esp32-esp32-s2-esp32-c3" aria-hidden="true">#</a> For ESP32/ESP32-S2/ESP32-C3**</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /path/to/esp-homekit-sdk/examples/fan
<span class="token builtin class-name">export</span> <span class="token assign-left variable">ESPPORT</span><span class="token operator">=</span>/dev/ttyUSB0 <span class="token comment">#Set your board&#39;s serial port here</span>
idf.py set-target <span class="token operator">&lt;</span>esp32/esp32s2/esp32c<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>
idf.py flash monitor
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="for-esp8266" tabindex="-1"><a class="header-anchor" href="#for-esp8266" aria-hidden="true">#</a> For ESP8266</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /path/to/esp-homekit-sdk/examples/fan
<span class="token builtin class-name">export</span> <span class="token assign-left variable">ESPPORT</span><span class="token operator">=</span>/dev/ttyUSB0 <span class="token comment">#Set your board&#39;s serial port here</span>
<span class="token function">make</span> defconfig
<span class="token function">make</span> flash monitor
<span class="token function">make</span> erase_flash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Note the <code>partitions_hap.csv</code> for ESP8266 is different from the one for ESP32/ESP32-S2/ESP32-C3. Please use the correct one.</p></blockquote><div class="hint-container warning"><p class="hint-container-title">ESP8266 Partition Table</p><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code># Name,   Type, SubType, Offset,  Size, Flags
# Note: if you change the phy_init or app partition offset, make sure to change the offset in Kconfig.projbuild
nvs,      data, nvs,     0x9000,  0x6000,
phy_init, data, phy,     0xf000,  0x1000,
factory,  app,  factory, 0x10000, 1M,
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="hint-container warning"><p class="hint-container-title">ESP32/ESP32-S2/ESP32-C3 Partition Table</p><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code># Name,   Type, SubType, Offset,  Size, Flags
# Note: Firmware partition offset needs to be 64K aligned, initial 36K (9 sectors) are reserved for bootloader and partition table
sec_cert,  0x3F, ,0xd000,    0x3000, ,  # Never mark this as an encrypted partition
nvs,      data, nvs,     0x10000,   0x6000,
otadata,  data, ota,     ,          0x2000
phy_init, data, phy,     ,          0x1000,
ota_0,    app,  ota_0,   0x20000,   1600K,
ota_1,    app,  ota_1,   ,          1600K,
factory_nvs, data,   nvs,     0x340000,  0x6000
nvs_keys, data, nvs_keys,0x346000,  0x1000
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div>`,13),P={href:"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/provisioning/provisioning.html#provisioning-tools",target:"_blank",rel:"noopener noreferrer"},E=n('<blockquote><p>Note: For the Open source HomeKit SDK, the HomeKit QR code cannot be used for provisioning from the Home app. It can be used only for pairing, after the Wi-Fi provisioning is done. For provisioning from Home app, you will need the MFi variant of the SDK. Note: If you want to use hard-coded credentials instead of Provisioning, please set the ssid and passphrase by navigating to <code>idf.py menuconfig -&gt; App Wi-Fi -&gt; Source of Wi-Fi Credentials -&gt; Use Hardcoded</code></p></blockquote><p>After the device connects to your Home Wi-Fi network it can be added in the Home app</p><h3 id="add-acccessory-in-the-home-app" tabindex="-1"><a class="header-anchor" href="#add-acccessory-in-the-home-app" aria-hidden="true">#</a> Add acccessory in the Home app</h3><p>Open the Home app on your iPhone/iPad and follow these steps</p><ul><li>Tap on &quot;Add Accessory&quot; and scan the small QR code mentioned above.</li><li>If QR code is not visible correctly, you may use the link printed on the serial terminal or follow these steps: <ul><li>Choose the &quot;I Don&#39;t Have a Code or Cannot Scan&quot; option.</li><li>Tap on &quot;Esp-Fan-xxxxxx&quot; in the list of Nearby Accessories.</li><li>Select the &quot;Add Anyway&quot; option for the &quot;Uncertified Accessory&quot; prompt.</li><li>Enter 11122333 as the Setup code.</li></ul></li><li>You should eventually see the &quot;Esp-Fan-xxxxxx added&quot; message.</li><li>Give a custom name, assign to a room, create scenes as required and you are done.</li></ul><blockquote><p>For ESP8266, the pairing may take a bit longer.</p></blockquote><h2 id="faq" tabindex="-1"><a class="header-anchor" href="#faq" aria-hidden="true">#</a> FAQ</h2>',7),w={href:"https://github.com/DaMiBear/ESP32_HomeKit_AirConditioner/issues/2",target:"_blank",rel:"noopener noreferrer"},q=e("p",null,"Answer:",-1),K=e("ol",null,[e("li",null,[s("use "),e("code",null,"idf.py erase_flash"),s(" to erase the "),e("code",null,"ESP32"),s(" flash, then flash the firmware again.")]),e("li",null,[s("use "),e("code",null,"make erase_flash"),s(" to erase the "),e("code",null,"ESP8266"),s(" flash, then flash the firmware again.")])],-1);function F(A,H){const a=i("ExternalLinkIcon");return r(),l("div",null,[c,e("p",null,[e("a",p,[s("HomeKit"),t(a)]),s(" is a framework developed by Apple for communicating with and controlling connected accessories in a user’s home using iOS devices. ESP HomeKit SDK has been developed in-house by Espressif to build Apple HomeKit compatible accessories using ESP32/ESP32-S2/ESP32-C3/ESP8266 SoCs.")]),e("blockquote",null,[e("p",null,[s("Note: If you want to use HomeKit for commercial products, please check "),e("a",h,[s("here"),t(a)]),s(" for access to the MFi variant of this SDK. It has the exact same APIs as this and so, moving to it should be easy. However, commercial HomeKit products can be built only with ESP32/ESP32-S2/ESP32-C3 since ESP8266 cannot meet all the HomeKit Certification requirements. If you want to use a port of Apple's ADK instead, please check "),e("a",u,[s("here"),t(a)])])]),m,f,v,b,e("p",null,[s("Set up the host environment and ESP IDF ("),g,s(" branch) as per the steps given "),e("a",k,[s("here"),t(a)]),s(".")]),e("p",null,[s("If you are using "),S,s(", set-up ESP8266-RTOS-SDK ("),_,s(" branch) as per the steps given "),e("a",y,[s("here"),t(a)]),s(".")]),x,e("p",null,[s("As the device boots up, you will see two QR codes, a small one for HomeKit and a larger one for Wi-Fi provisioning. Please use any of the "),e("a",P,[s("Espressif Provisioning Apps"),t(a)]),s(" for Wi-Fi provisioning.")]),E,e("blockquote",null,[e("ol",null,[e("li",null,[s("Question: "),e("a",w,[s("此设备已经被添加到其他家庭"),t(a)])])])]),q,K])}const N=o(d,[["render",F],["__file","homekit.html.vue"]]);export{N as default};
